# Fusion Serendipitous Recommender

This github repo presents the major code implementations for the paper: 

[Fusion Serendipitous Recommendation System.pdf](./Fusion%20Serendipitous%20Recommendation%20System.pdf)

This paper builds upon and enhances the original work developed during our final project for **CSE158: Web Mining & Recommender Systems**, instructed by [**Prof. Julian McAuley**](https://cseweb.ucsd.edu/~jmcauley).

Authors: Yijie Ding, Xunzhi He, Jiaheng Dai


## Abstract

In various scenarios, online recommendation systems are increasingly expected not only to exploit users' interests but also to facilitate exploration. Therefore, it becomes crucial to prioritize not just accuracy but a balanced serendipity, which we define as relevance, diversity, and unexpectedness. Current methods often construct serendipity vectors based on heuristics and alter the normal recommendation outcomes, which offers explainability but lacks alignment with genuine customer feedback. To bridge this gap, we propose the **Serendipitous Recommendation System (SRS)** that employs:
1. a Sequential Category-Prediction model implemented using a Long Short-Term Memory (LSTM) to capture usersâ€™ short-term demand, and
2. a Latent Factor Model (LFM) trained on real customer review sentiments for estimating user unexpectedness based on their long-term preference.

Recommendations are generated by aggregating the relevance and unexpectedness score using an adjustable weight $\lambda$. We then conduct experiments to compare the SRS with a Bayesian Personal Ranking (BPR) baseline using the serendipitous metrics and empirically discuss the effect of $\lambda$ on recommendation results. Our results demonstrate both SRS's efficacy and explainability in enhancing recommendation serendipity, offering a novel approach to consumer product suggestions.

## Overview

<img width="914" alt="enhanced" src="https://github.com/Jamesding000/CSE158_Seredipitous_Recommender/assets/100378969/ee36b343-2243-4724-8122-853212d79691">

Our framework, the **Serendipitous Recommendation System (SRS)**, introduces a novel approach to crafting recommendations that are serendipitous (i.e., both relevant and unexpectedly delightful) to users. The system is built upon a fusion-model architecture: 

- A **Sequential Prediction model** that discerns short-term user demands by sequence modeling of item categories
- A **Latent Unexpectedness Estimator** that assesses the element of surprise in user-item interactions.

The Sequential Prediction model employs a Long-Short Term Memory (LSTM) model, adept at capturing intricate sequential patterns in purchase histories, thus ensuring relevance in recommendations. Complementing this, our unexpectedness estimator leverages a Latent Factor Model (LFM) trained on surprise scores of the customer review text, which are projected by the distilRoBERTa-base model, to quantify the novelty or unexpectedness of recommendations. A balance factor harmoniously integrates relevance and unexpectedness scores, culminating in a set of top $k$ serendipitous recommendations. This unique blend of predictive accuracy and surprise embodies our system's core philosophy, promising not just to meet but to exceed user expectations.

<img width="936" alt="lstm" src="https://github.com/Jamesding000/CSE158_Seredipitous_Recommender/assets/100378969/c76b3f0c-d5e8-433c-95ec-7881cb2da2f8">

<img width="936" alt="lfm" src="https://github.com/Jamesding000/CSE158_Seredipitous_Recommender/assets/100378969/b8131d55-84e6-47e0-b06a-5aeacd301d25">
